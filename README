DMFinder v1.0

Publication:
Matthew Hayes and Jing Li. "An integrative framework for the identification of double minute chromosomes using next generation sequencing data". BMC Genetics, 2015, 16(Suppl 2):S1.

Contact:
	*Matthew Hayes
	mhayes@case.edu

	Jing Li
	jingli@case.edu
	* - corresponding author




Contents
	I. Requirements
	II. Installation
	III. Associated programs
	IV. Configuring Bellerophon
	V. Output format



------------------------------------------------------------------------
I. Requirements


	********NOTE: DMFinder can only analyze PAIRED-END data produced with **Illumina** platforms (i.e. read pairs with forward-reverse orientation).************

	Please make sure that chromosome names in the input BAM file are in the following format: chr1, chr2, chr3...


	DMFinder has three external dependencies: SamTools, Graph, and GraphEasy. The link to each is provided here:

	SamTools
	http://samtools.sourceforge.net/
	
	Graph
	http://search.cpan.org/~jhi/Graph-0.9704/lib/Graph.pod
	
	GraphEasy
	http://search.cpan.org/~tels/Graph-Easy/lib/Graph/Easy.pm
	
	The Graph package is provides the infrastructure for implementing the graph algorithms used by DMFinder. The GraphEasy package allows for visualization of the predicted double minutes (written to a file called "graph.dot").


------------------------------------------------------------------------

II. Installation
	
	****Be sure to add the SamTools directory to your PATH variable****.

	Once the dependencies have been installed and the files have been extracted, DMFinder can be executed with the following command:

		perl dm_find.pl
	
	NOTE: The dm_find_core.pl program contains most of the ogic to run the program, but it is not recommended that you execute this file directly. 
-----------------------------------------------------------------------

III. Running DMFinder

perl dmfind.pl --input_bam {indexed and sorted bam file} --sv {structural variant coordinates in VCF format} --cn {copy number variant coordinates in BED format} [OPTIONS]

OPTIONS

	--min_cyclic				Minimum number of amplicons in cyclic chain to predict as a double minute [2]
	--min_non_cyclic			Minimum number of amplicons in a non-cyclic chain to predict as a DM [2]
	--cutoff				Cutoff coefficient of mapped read pair standard deviation [4]
	--mean					Mean mapped distance between read pairs [400]
	--stdev					Standard deviation of mapped distances between reads [80]
	--minqual				Minimum read mapping quality to estimate mapping coverage [30]
	--window				Maximum number of base pairs to define proximity between copy number breakpoint and structural variant breakpoint [2*(cutoff*stdev+mean)]


	A. input_bam
		This should be a coordinate-sorted bam file with an associated index file. The index filename should be your bam filename with ".bai" affixed to the end.
	B. sv
		This is a VCF format file that contains the structural variant breakpoints. **You must convert your structural variant breakpoint prediction files into VCF format to be read by DMFinder**.
	C. cn
		This is a BED format file that contains coordinates corresponding to copy number amplified segments. **DMFinder assumes these regions correspond to segments of copy number gain**.
	D. min_cyclic
		For circular (cyclic) sub-graphs, this is the minimum number of amplicons (vertices) that must exist for predicting a double minute. 
	E. min_non_cyclic
		For NON-circular sub-graphs, this is the minimum number of amplicons (vertices) that must exist for predicting double minute. Per algorithm 3, this is the smallest allowable weakly connected component that is allowed to predict a double minute.
	F. cutoff
		This is the coefficient of standard deviations of the mean for measuring the window size. Not used if the user specifies a window length.
	G. mean
		This is the mean mapped distance between read pairs (insert size) of the input bam file. Not used if the user specifies a window length.
	H stdev
		Standard deviation of mapped distances of read pairs of the input bam file. Not used if the user specifies a window length.
	I. minqual
		Minimum read mapping quality for computing amplicon read coverage.
	J. window
		Maximum distance between amplicons (vertices) to connect by an edge. 	 
		
------------------------------------------------------------------------

V. Output format

	The graph for the double minutes is located in the file "graph.dot". 

	Through standard output, DMFinder lists the read depth of each amplicon identified in the double minute before giving a list of predicted double minute chromosomes. The program also creates the file "graph.dot" which contains the graphs of each predicted double minute. It can be visualized using GraphViz (http://www.graphviz.org).
	
	For listing COMPLETE double minutes, DMFinder lists the connected amplicons in the following format:

	SEGMENT FOR PREDICTED DOUBLE MINUTE
	CHR1	START1	END1	CHR2	START2	END2	CHR3	START3	END3

	So in the above example, the segment at CHR1 is connected with the segment at CHR2, which is connected to the segment at CHR3. The CHR3 segment is then connected with the CHR1 segment. 

	For the INCOMPLETE double minutes, the program also lists the amplicons that participate in the double minute, but not in any particular order.    	
	
